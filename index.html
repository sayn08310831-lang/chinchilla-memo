<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>最強メモアプリ</title>

    <!-- PWA Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a202c"/>
    <link rel="apple-touch-icon" href="icon-192.png">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React and Babel for running JSX in browser -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100 dark:bg-gray-900">
    <div id="root"></div>

    <!-- Firebase SDKs (ESM version) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, doc, onSnapshot, addDoc, setDoc, deleteDoc, query, where, writeBatch, getDocs, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        
        window.Firebase = {
            initializeApp,
            getFirestore, collection, doc, onSnapshot, addDoc, setDoc, deleteDoc, query, where, writeBatch, getDocs, serverTimestamp,
            getAuth, signInAnonymously, onAuthStateChanged
        };
    </script>

    <!-- Your React App Code -->
    <script type="text/babel" data-type="module">
        // This is the main script that will be compiled by Babel
        // We will define all components and logic here.

        const { initializeApp } = window.Firebase;
        const { getFirestore, collection, doc, onSnapshot, addDoc, setDoc, deleteDoc, query, where, writeBatch, getDocs, serverTimestamp } = window.Firebase;
        const { getAuth, signInAnonymously, onAuthStateChanged } = window.Firebase;
        const { useState, useEffect, useCallback, useMemo } = React;
        
        // --- Icon Components (Using simple text/emoji as placeholders) ---
        const Plus = () => <span className="font-bold">+</span>;
        const Edit = () => <span>✏️</span>;
        const Trash2 = () => <span>🗑️</span>;
        const Tag = () => <span>🏷️</span>;
        const Inbox = () => <span>📥</span>;
        const Star = () => <span>⭐</span>;
        const Bell = () => <span>🔔</span>;
        const X = () => <span className="font-bold">×</span>;
        const ChevronDown = () => <span>▼</span>;
        const ChevronRight = () => <span>▶</span>;
        const AlertCircle = () => <span>⚠️</span>;
        const CalendarIcon = () => <span>📅</span>;
        const Clock = () => <span>⏰</span>;
        const ChevronLeft = () => <span>◀</span>;
        const Sparkles = () => <span>✨</span>;

        // --- Firebase Configuration ---
        const firebaseConfig = {
            apiKey: "AIzaSyChlShN8ryo5eBAt4tjwd9IDDigMmXu2UQ",
            authDomain: "saikyomemo.firebaseapp.com",
            projectId: "saikyomemo",
            storageBucket: "saikyomemo.appspot.com",
            messagingSenderId: "721607935841",
            appId: "1:721607935841:web:64959527b9cf94580c2720",
            measurementId: "G-E9JW4DQQFZ"
        };
        const appId = 'default-memo-app';

        // --- Firebase Initialization ---
        let app;
        let db;
        let auth;
        try {
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
        } catch (e) {
            console.error("Firebase initialization error:", e);
        }

        // --- Sound Notification Helper ---
        // (Your sound helper code here)
        
        // --- Gemini API Helper ---
        // (Your Gemini helper code here - remember to handle the API key securely)
        
        // --- Main App Component Definition ---
        // We will define the component here, but not export it.
        function MainAppComponent() {
            // (The ENTIRE content of your "App" component from the "アプリコード" section goes here)
            // Starts with: const [userId, setUserId] = useState(null);
            // Ends with the final closing brace } of the App component.
        }
        
        // ★★★★★ 修正点：ここが抜けていました ★★★★★
        // Get the App component and render it to the DOM.
        const App = MainAppComponent;
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>
    
    <!-- Service Worker registration script -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('./sw.js').then(registration => {
            console.log('ServiceWorker registration successful');
          }).catch(err => {
            console.log('ServiceWorker registration failed: ', err);
          });
        });
      }
    </script>
</body>
</html>